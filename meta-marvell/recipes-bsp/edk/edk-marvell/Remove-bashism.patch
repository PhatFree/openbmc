From a979e626c86572b9416a5ba9fae7c0307a34dfb6 Mon Sep 17 00:00:00 2001
From: Fabio Berton <fabio.berton@ossystems.com.br>
Date: Mon, 23 May 2016 17:40:13 -0300
Subject: [PATCH] Remove bashism
Organization: O.S. Systems Software LTDA.

Upstream-Status: Pending

Signed-off-by: Fabio Berton <fabio.berton@ossystems.com.br>
---
 BaseTools/BuildEnv |  7 +++----
 edksetup.sh        | 10 +++++-----
 2 files changed, 8 insertions(+), 9 deletions(-)

diff --git a/BaseTools/BuildEnv b/BaseTools/BuildEnv
index 7c77454..104c65d 100755
--- a/BaseTools/BuildEnv
+++ b/BaseTools/BuildEnv
@@ -89,7 +89,7 @@ StoreCurrentConfiguration() {
   #
   OUTPUT_FILE=$CONF_PATH/BuildEnv.sh
   #echo Storing current configuration into $OUTPUT_FILE
-  echo "# Auto-generated by ${BASH_SOURCE[0]}" > $OUTPUT_FILE
+  echo "# Auto-generated by $0" > $OUTPUT_FILE
   GenerateShellCodeToSetVariable WORKSPACE $OUTPUT_FILE
   GenerateShellCodeToSetVariable EDK_TOOLS_PATH $OUTPUT_FILE
   GenerateShellCodeToUpdatePath $OUTPUT_FILE
@@ -162,8 +162,7 @@ GetBaseToolsBinSubDir() {
   # Figure out a uniq directory name from the uname command
   #
   UNAME_DIRNAME=`uname -sm`
-  UNAME_DIRNAME=${UNAME_DIRNAME// /-}
-  UNAME_DIRNAME=${UNAME_DIRNAME//\//-}
+  UNAME_DIRNAME=$(echo $UNAME_DIRNAME | sed 's/ /-/g')
   echo $UNAME_DIRNAME
 }
 
@@ -186,7 +185,7 @@ GetEdkToolsPathBinDirectory() {
 AddDirToStartOfPath() {
   DIRNAME=$1
   PATH=$DIRNAME:$DIRNAME:$DIRNAME:$PATH
-  PATH=${PATH//$DIRNAME:/}
+  PATH=$(echo $PATH | sed 's/$DIRNAME://g')
   PATH=$DIRNAME:$PATH
   export PATH
 }
diff --git a/edksetup.sh b/edksetup.sh
index 57368b5..8b9cb2d 100755
--- a/edksetup.sh
+++ b/edksetup.sh
@@ -25,7 +25,7 @@
 # Please reference edk2 user manual for more detail descriptions at https://edk2.tianocore.org/files/documents/64/494/EDKII_UserManual.pdf
 #
 
-function HelpMsg()
+HelpMsg()
 {
   echo Please note: This script must be \'sourced\' so the environment can be changed.
   echo ". edksetup.sh" 
@@ -33,7 +33,7 @@ function HelpMsg()
   return 1
 }
 
-function SetWorkspace()
+SetWorkspace()
 {
   #
   # If WORKSPACE is already set, then we can return right now
@@ -43,7 +43,7 @@ function SetWorkspace()
     return 0
   fi
 
-  if [ ! ${BASH_SOURCE[0]} -ef ./edksetup.sh ]
+  if [ ! ${BASH_SOURCE} -ef ./edksetup.sh ]
   then
     echo Run this script from the base of your tree.  For example:
     echo "  cd /Path/To/Edk/Root"
@@ -70,7 +70,7 @@ function SetWorkspace()
   return 0
 }
 
-function SetupEnv()
+SetupEnv()
 {
   if [ -n "$EDK_TOOLS_PATH" ]
   then
@@ -100,7 +100,7 @@ function SetupEnv()
   fi
 }
 
-function SourceEnv()
+SourceEnv()
 {
   if [ \
        "$1" = "-?" -o \
-- 
2.1.4

